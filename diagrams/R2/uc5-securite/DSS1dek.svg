<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="794" height="414" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[participant SCKMS
participant VAULT
Note over SCKMS,VAULT: Communication over secure channel
SCKMS->VAULT: Asks for the DEK secret
VAULT-->SCKMS: Returns the DEK secret
SCKMS->SCKMS: Base 64 decode the encrypted DEK
SCKMS->VAULT: Sends decrypt DEK request
VAULT->VAULT: Decrypts the DEK using the KEK
VAULT-->SCKMS: Returns the decrypted DEK

]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="10" y="20" width="68.828125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="44.765625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">SCKMS</tspan></text></g><g class="actor"><rect x="10" y="356.5" width="68.828125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="381.265625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">SCKMS</tspan></text></g><line x1="44.4140625" x2="44.4140625" y1="58.3125" y2="356.5" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="362.421875" y="20" width="68.828125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="372.421875" y="44.765625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="372.421875">VAULT</tspan></text></g><g class="actor"><rect x="362.421875" y="356.5" width="68.828125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="372.421875" y="381.265625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="372.421875">VAULT</tspan></text></g><line x1="396.8359375" x2="396.8359375" y1="58.3125" y2="356.5" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="note"><rect x="34.4140625" y="78.3125" width="372.421875" height="28.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="39.4140625" y="98.078125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="39.4140625">Communication over secure channel</tspan></text></g><g class="signal"><text x="108.34375" y="137.234375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="108.34375">Asks for the DEK secret</tspan></text><line x1="44.4140625" x2="396.8359375" y1="144.9375" y2="144.9375" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="113.2265625" y="175.546875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="113.2265625">Returns the DEK secret</tspan></text><line x1="396.8359375" x2="44.4140625" y1="183.25" y2="183.25" style="stroke-width: 2px; stroke-dasharray: 6px, 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="69.4140625" y="217.40625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="69.4140625">Base 64 decode the encrypted DEK</tspan></text><line x1="44.4140625" x2="64.4140625" y1="203.25" y2="203.25" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="64.4140625" x2="64.4140625" y1="203.25" y2="226.5625" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="64.4140625" x2="44.4140625" y1="226.5625" y2="226.5625" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="98.5859375" y="252.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="98.5859375">Sends decrypt DEK request</tspan></text><line x1="44.4140625" x2="396.8359375" y1="259.875" y2="259.875" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="421.8359375" y="294.03125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="421.8359375">Decrypts the DEK using the KEK</tspan></text><line x1="396.8359375" x2="416.8359375" y1="279.875" y2="279.875" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="416.8359375" x2="416.8359375" y1="279.875" y2="303.1875" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="416.8359375" x2="396.8359375" y1="303.1875" y2="303.1875" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="98.5859375" y="328.796875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="98.5859375">Returns the decrypted DEK</tspan></text><line x1="396.8359375" x2="44.4140625" y1="336.5" y2="336.5" style="stroke-width: 2px; stroke-dasharray: 6px, 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>