<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1394" height="491" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[participant WS 
participant CRYPTOLIB
participant SCKMS
WS->SCKMS: Sends DEK retrieval request
Note left of WS: WS wants to encrypt some data
SCKMS-->WS: Returns the DEK
WS->CRYPTOLIB: Asks for a random nonce generation
CRYPTOLIB->CRYPTOLIB: Generates a random nonce
CRYPTOLIB-->WS: Returns random nonce
WS->CRYPTOLIB: Asks for encryption using AES (providing the DEK and the nonce)
CRYPTOLIB->CRYPTOLIB: Checks the DEK and nonce validity
CRYPTOLIB-->WS: OK, return the ciphertext




]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="313.375" y="20" width="39.53125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="323.375" y="44.765625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="323.375">WS</tspan></text></g><g class="actor"><rect x="313.375" y="433.125" width="39.53125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="323.375" y="457.890625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="323.375">WS</tspan></text></g><line x1="333.140625" x2="333.140625" y1="58.3125" y2="433.125" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="914.28125" y="20" width="107.875" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="924.28125" y="44.765625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="924.28125">CRYPTOLIB</tspan></text></g><g class="actor"><rect x="914.28125" y="433.125" width="107.875" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="924.28125" y="457.890625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="924.28125">CRYPTOLIB</tspan></text></g><line x1="968.21875" x2="968.21875" y1="58.3125" y2="433.125" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="1295.9921875" y="20" width="68.828125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1305.9921875" y="44.765625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1305.9921875">SCKMS</tspan></text></g><g class="actor"><rect x="1295.9921875" y="433.125" width="68.828125" height="38.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1305.9921875" y="457.890625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1305.9921875">SCKMS</tspan></text></g><line x1="1330.40625" x2="1330.40625" y1="58.3125" y2="433.125" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="signal"><text x="699.96875" y="88.921875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="699.96875">Sends DEK retrieval request</tspan></text><line x1="333.140625" x2="1330.40625" y1="96.625" y2="96.625" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="20" y="116.625" width="293.140625" height="28.3125" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="25" y="136.390625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="25">WS wants to encrypt some data</tspan></text></g><g class="signal"><text x="758.546875" y="175.546875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="758.546875">Returns the DEK</tspan></text><line x1="1330.40625" x2="333.140625" y1="183.25" y2="183.25" style="stroke-width: 2px; stroke-dasharray: 6px, 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="484.703125" y="213.859375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="484.703125">Asks for a random nonce generation</tspan></text><line x1="333.140625" x2="968.21875" y1="221.5625" y2="221.5625" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="993.21875" y="255.71875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="993.21875">Generates a random nonce</tspan></text><line x1="968.21875" x2="988.21875" y1="241.5625" y2="241.5625" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="988.21875" x2="988.21875" y1="241.5625" y2="264.875" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="988.21875" x2="968.21875" y1="264.875" y2="264.875" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="553.046875" y="290.484375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="553.046875">Returns random nonce</tspan></text><line x1="968.21875" x2="333.140625" y1="298.1875" y2="298.1875" style="stroke-width: 2px; stroke-dasharray: 6px, 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="343.140625" y="328.796875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="343.140625">Asks for encryption using AES (providing the DEK and the nonce)</tspan></text><line x1="333.140625" x2="968.21875" y1="336.5" y2="336.5" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="993.21875" y="370.65625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="993.21875">Checks the DEK and nonce validity</tspan></text><line x1="968.21875" x2="988.21875" y1="356.5" y2="356.5" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="988.21875" x2="988.21875" y1="356.5" y2="379.8125" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="988.21875" x2="968.21875" y1="379.8125" y2="379.8125" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="528.640625" y="405.421875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="528.640625">OK, return the ciphertext</tspan></text><line x1="968.21875" x2="333.140625" y1="413.125" y2="413.125" style="stroke-width: 2px; stroke-dasharray: 6px, 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>